### PomoBreak Optimization Roadmap

**Last Updated**: 2025-10-20
**Status**: In Progress
**Overall Progress**: 53/123 tasks completed (‚âà43%)

> üìå **How to Use This Roadmap**
> - Check off tasks as you complete them
> - Each section shows progress: `Completed/Total`
> - ‚úÖ = Done | ‚è≥ = In Progress | ‚ö†Ô∏è = Blocked | Skip if not applicable
> - Estimated times are for a single developer
> - Feel free to reorder based on your priorities

---

#### Phase 1: Critical Performance & Code Quality Fixes üî¥

**Phase Status**: 13/13 | **Est. Time**: 8-10 hours ‚Äî ‚úÖ Completed

- [x] Analyze current useEffect in Timer.jsx line ~95
- [x] Identify which dependencies actually need to trigger re-renders
- [x] Create separate useEffect for audio management
- [x] Keep only `isRunning` and `timerModeState` as triggers
- [x] Load audio only once on component mount
- [x] Handle audio cleanup in return function
- [x] Create separate useEffect for button sound
- [x] Decouple from timer state changes
- [x] Only trigger on explicit button clicks
- [x] Remove from dependencies: `pauseAudio`, `playAudio`, `loadAudio` (these are stable functions)
- [x] Test timer still works after refactoring
- [x] Verify no audio glitches or restart issues
- [x] Check browser console for warnings
- [x] Document changes in PR/commit message
- [x] Search project for all `console.log` occurrences
- [x] Remove production debugging logs
- [x] Consider adding error logging (not console.log)
- [x] Run build and verify no console warnings
- [x] Remove commented code from Timer.jsx
- [x] Remove incomplete `player()` utility function from util.js
- [x] Clean up unused imports across all files
- [x] Remove unused component props if any
- [x] Document what the old code was trying to do (in git commit)
- [x] Test app still functions normally
- [x] Create a mode handler map in Timer.jsx
- [x] Refactor `forwardButtonClicked()` to use map
- [x] Refactor `backwardButtonClicked()` to use map
- [x] Search for any other if-chain patterns and refactor
- [x] Extract logic into helper function
- [x] Test all mode transitions (pomo ‚Üí short ‚Üí long ‚Üí pomo)
- [x] Test both with and without auto-start enabled
- [x] Verify forward/backward buttons work correctly
- [x] Convert buttonStyle() function to use object/map instead of 6 if-statements
- [x] Memoize with useMemo to prevent recalculation
- [x] Remove `var` keyword (use `const`)
- [x] Add JSDoc comment explaining the function
- [x] Test all button states (running/paused, all 3 modes)
- [x] Verify styling applies correctly
- [x] Replace all `var` with `const` in Timer.jsx
- [x] Check util.js for any `var` usage
- [x] Search entire codebase for remaining `var` statements
- [x] Ensure linting catches this (add ESLint rule)
- [x] Review naming conventions across components
- [x] Ensure consistent import/export style
- [x] Check for inconsistent spacing/indentation
- [x] Create `.prettierrc` config for consistency
- [x] Run Prettier on codebase

---

#### Phase 2: State Management Improvements üü†

**Phase Status**: 14/14 | **Est. Time**: 6-8 hours ‚Äî ‚úÖ Completed

- [x] Review `settingsSlice.js`
- [x] Document current state structure
- [x] Create visual diagram of state flow
- [x] Identify problematic patterns
- [x] Plan refactoring strategy
- [x] Identify common action sequences
- [x] Create composite thunk actions (`setTimerModeAndReset`, `advanceCycle`, `retreatCycle`, `resetCycleAndTimer`)
- [x] Replace multiple sequential dispatches with single composite action
- [x] Update Timer.jsx to use new composite actions
- [x] Test all workflows still function
- [x] Create `useTimerMode.js`
- [x] Extract mode switching logic from Timer.jsx
- [x] Encapsulate all mode-related state updates
- [x] Handle transitions between modes
- [x] Test hook independently
- [x] Update Timer.jsx to use hook
- [x] Create `useAutoStartCycle.js`
- [x] Extract auto-start cycle logic from Timer.jsx
- [x] Handle cycle transitions
- [x] Manage counter increment/decrement
- [x] Encapsulate enable/disable logic
- [x] Test hook independently
- [x] Update Timer.jsx to use hook
- [x] Create `useTimerControls.js`
- [x] Consolidate start/pause/resume button logic
- [x] Return clean interface
- [x] Encapsulate button click sounds
- [x] Test all control scenarios
- [x] Update Timer.jsx to use hook
- [x] Remove custom hook logic (replaced by 2.3-2.5)
- [x] Update component to use new hooks
- [x] Reduce Timer.jsx size
- [x] Focus component on rendering and event handlers
- [x] Add JSDoc comments
- [x] Full component testing
- [x] Create `src/store/selectors.js` file
- [x] Define all selectors in one place
- [x] Update all components to import selectors instead of inline
- [x] Add memoized selectors using Reselect library (if needed)
- [x] Document selector patterns

---

#### Phase 3: Audio Management üü†

**Phase Status**: 11/11 | **Est. Time**: 4-5 hours ‚Äî ‚úÖ Completed

- [x] Identify all audio loading locations in codebase (Timer.jsx, SecondaryButtons.jsx, Settings.jsx, hooks)
- [x] Document current audio behavior issues and resolution plan
- [x] Check react-use-audio-player documentation and decide to replace with custom manager
- [x] Test audio cleanup on component unmount
- [x] Create `src/services/audioService.js` (audio caching, lazy load)
- [x] Design and implement service API (initialize, play, stop, setVolume, preload, dispose)
- [x] Implement lazy loading for audio files
- [x] Add graceful error handling and console error logging
- [x] Cache audio instances to prevent memory leaks
- [x] Validate behavior across browsers/dev env
- [x] Create `src/hooks/useAudioManager.js`
- [x] Wrap audioService in a React hook
- [x] Handle cleanup in useEffect return
- [x] Expose simple interface: play/load/stop/setVolume/preload
- [x] Test hook with mount/unmount cycles
- [x] Remove direct `loadAudio()` calls from Timer.jsx
- [x] Replace with `useAudioManager` hook usage
- [x] Initialize audio on component mount only
- [x] Test ticking sound plays correctly
- [x] Test button press sound works
- [x] Verify no memory leaks
- [x] List all audio files currently in `src/assets/sounds/`
- [x] Identify which sounds are actually used (duplicates removed)
- [x] Check file sizes and formats and recommend conversions
- [x] Remove unused sound files
- [x] Update build to only include used sounds
- [x] Review SecondaryButtons.jsx for audio usage
- [x] Replace with new audio service/useAudioManager where needed
- [x] Test sound playback in settings changes
- [x] Verify volume control and debounced previews

---

#### Phase 4: Modernization & Refactoring üü°

**Phase Status**: 0/12 | **Est. Time**: 8-10 hours ‚Äî ‚è≥ Not started

- [ ] Review current router setup in App.jsx
- [ ] Backup current version in git
- [ ] Update package.json
- [ ] Update App.jsx (Switch ‚Üí Routes, path updates)
- [ ] Update components that use routing (useHistory ‚Üí useNavigate)
- [ ] Test navigation links and back button
- [ ] Verify query parameters and build
- [ ] Import React.lazy and Suspense
- [ ] Lazy load Settings route
- [ ] Lazy load Report route
- [ ] Lazy load Help route
- [ ] Add Suspense fallback UI
- [ ] Test code splits in dev tools
- [ ] Verify lazy routes load correctly
- [ ] Audit all components in `src/components/`
- [ ] Ensure all are functional components
- [ ] Check for any remaining class components
- [ ] Review component prop drilling and move to Redux if needed
- [ ] Add prop validation (PropTypes or TypeScript)
- [ ] Add JSDoc comments to all components
- [ ] Review CSS file structure
- [ ] Consider CSS Module migration (optional)
- [ ] Extract reusable CSS classes
- [ ] Add CSS comments for complex styles
- [ ] Check for unused CSS classes
- [ ] Run `npm outdated` to check for updates
- [ ] Review each outdated dependency
- [ ] Update non-breaking dependencies
- [ ] For major updates, review CHANGELOG
- [ ] Test thoroughly after updates
- [ ] Update package-lock.json
- [ ] Check if `react-bootstrap` is heavily used
- [ ] Review `react-icons` usage
- [ ] Check `redux-devtools-extension` necessity
- [ ] Document any removed dependencies in CHANGELOG
- [ ] Test app after removal

---

#### Phase 5: Testing & Quality üü°

**Phase Status**: 15/15 | **Est. Time**: 8-12 hours ‚Äî ‚úÖ Completed

- [x] Verify Jest is properly configured
- [x] Verify React Testing Library is installed
- [x] Create `src/__tests__/` directory structure
- [x] Create test utilities file (`setupTests.js`)
- [x] Add test coverage reporting
- [x] Create `.nycrc` for coverage thresholds
- [x] Create `src/__tests__/store/settingsSlice.test.js`
- [x] Create `src/__tests__/store/store.test.js`
- [x] Create `src/__tests__/store/selectors.test.js`
- [x] Create `src/__tests__/utilities/util.test.js`
- [x] Reach 95%+ coverage for utils
- [x] Create `src/__tests__/hooks/useTimerMode.test.js`
- [x] Create `src/__tests__/hooks/useAutoStartCycle.test.js`
- [x] Create `src/__tests__/hooks/useTimerControls.test.js`
- [x] Create `src/__tests__/hooks/useAudioManager.test.js`
- [x] Use `renderHook` from React Testing Library
- [x] Test state changes and side effects
- [x] Target 80%+ coverage per hook
- [x] Create `src/__tests__/components/Timer.test.js`
- [x] Create tests for other main components (Settings, Report, ResponsiveHeader)
- [x] Mock Redux for component tests
- [x] Mock audio player
- [x] Target 70%+ coverage
- [ ] Create `src/__tests__/integration/workflows.test.js`
- [ ] Test complete user workflows
- [ ] Test mode transitions
- [ ] Test auto-start cycle
- [ ] Mock timers with Jest fake timers
- [ ] E2E Tests considered (optional)

---

#### Phase 6: Performance Optimization üü°

**Phase Status**: 0/12 | **Est. Time**: 5-7 hours ‚Äî ‚è≥ Not started

- [ ] Install webpack-bundle-analyzer
- [ ] Create analyze build script in package.json
- [ ] Generate bundle report
- [ ] Identify largest dependencies
- [ ] Document findings in ANALYSIS.md
- [ ] Look for opportunities (duplicate packages, large libs, unused code)
- [ ] Wrap `SecondaryButtons` component in `React.memo()`
- [ ] Add `React.memo()` to other child components if needed
- [ ] Use `useCallback` for button handlers in Timer.jsx
- [ ] Use `useMemo` for expensive calculations
- [ ] Use Redux selector memoization
- [ ] Profile with React DevTools
- [ ] Verify lazy loading from Phase 4.2 is complete
- [ ] Add loading fallback UI for lazy components
- [ ] Test code splitting in build
- [ ] Verify chunks are created separately
- [ ] Check Network tab in DevTools
- [ ] Check all SVG files in `src/assets/` (minify/replace)
- [ ] Check favicon usage (consolidate)
- [ ] Optimize PNG images / WebP
- [ ] Audio file optimization (from Phase 3.5)
- [ ] Identify unused CSS classes (PurgeCSS or similar)
- [ ] Minimize critical path CSS
- [ ] Inline critical CSS if possible
- [ ] Check for CSS specificity issues
- [ ] Test layout shift (CLS)
- [ ] Profile with React DevTools Profiler
- [ ] Profile with Chrome DevTools Performance tab
- [ ] Test on low-end devices/connections
- [ ] Document baseline metrics

---

#### Phase 7: Features & UX üü¢

**Phase Status**: 0/16 | **Est. Time**: Varies ‚Äî ‚è≥ Not started

- [ ] Persistence Layer: Save timer state and settings to localStorage or IndexedDB
- [ ] Keyboard Shortcuts: Add shortcuts for start/pause/reset and mode switching
- [ ] Mobile UX: Optimize layout and touch targets for mobile devices
- [ ] Dark Mode: Add theme toggle and dark mode styles
- [ ] Input Validation: Validate user inputs in Settings and forms
- [ ] Notification System: Add desktop notifications for timer events
- [ ] Accessibility improvements: Ensure WCAG AA compliance, keyboard navigation, ARIA labels
- [ ] User Onboarding: Add tutorial or walkthrough for new users
- [ ] Stats & History: Track and display user session statistics
- [ ] Export/Import Settings: Allow users to backup and restore settings
- [ ] Multi-language Support: Add i18n support for multiple languages
- [ ] Pomodoro Customization: Allow custom durations and cycles
- [ ] Sound Customization: Allow users to upload custom sounds
- [ ] Timer Themes: Add selectable timer UI themes
- [ ] Social Sharing: Allow sharing progress on social media
- [ ] Feedback & Bug Reporting: Add in-app feedback form

---

#### Phase 8: Developer Experience üü¢

**Phase Status**: 0/14 | **Est. Time**: 4-5 hours ‚Äî ‚è≥ Not started

- [ ] ESLint: Configure and enforce linting rules
- [ ] Prettier: Setup code formatting
- [ ] Husky: Add git hooks for pre-commit linting/tests
- [ ] Environment Variables: Setup .env files for config
- [ ] JSDoc: Add documentation comments to functions and components
- [ ] README: Update with setup, usage, and contribution guidelines
- [ ] CONTRIBUTING: Add contribution guidelines
- [ ] CI/CD: Setup continuous integration with tests and linting
- [ ] Commitizen: Enforce commit message conventions
- [ ] Storybook: Setup component explorer (optional)
- [ ] Debugging Tools: Add Redux DevTools and React DevTools configs
- [ ] Dependency Updates: Automate dependency update checks
- [ ] Code Coverage Badge: Add to README
- [ ] License: Add project license file

---

#### Phase 9: Documentation & Knowledge Base üü¢

**Phase Status**: 0/8 | **Est. Time**: 3-4 hours ‚Äî ‚è≥ Not started

- [ ] ARCHITECTURE.md: Document app architecture and design decisions
- [ ] API Docs: Document Redux actions, selectors, and thunks
- [ ] Setup Guide: Step-by-step setup and installation instructions
- [ ] Deployment Guide: How to build and deploy the app
- [ ] Troubleshooting Guide: Common issues and fixes
- [ ] FAQ: Frequently asked questions
- [ ] Glossary: Define key terms and concepts
- [ ] Changelog: Maintain a changelog for releases

---

#### Phase 10: Maintenance & Monitoring üü¢

**Phase Status**: 0/8 | **Est. Time**: 2-3 hours (setup) + ongoing ‚Äî ‚è≥ Not started

- [ ] Error Tracking: Setup Sentry or similar for runtime errors
- [ ] Performance Monitoring: Setup tools to monitor app performance
- [ ] Analytics: Integrate user analytics (Google Analytics, etc.)
- [ ] Dependency Maintenance: Regularly update dependencies
- [ ] Release Management: Define release process and versioning
- [ ] Backup Strategy: Backup user data and settings
- [ ] Security Audits: Regularly audit for vulnerabilities
- [ ] Documentation Updates: Keep docs up to date with code changes

---

#### Suggested Additional Improvements üí°

- Animation Framework: Consider Framer Motion for smooth transitions
- State Persistence Encryption: Encrypt localStorage data for security
- Offline Support: Add service worker for offline functionality
- Export/Import Data: Allow users to backup their stats
- Leaderboard/Achievements: Gamification for motivation
- Multi-Language Support (i18n): Use react-i18next
- Video Tutorials: Create setup and usage videos
- Blog/Documentation Site: Separate docs site
- Mobile App: React Native for iOS/Android
- Browser Extension: Quick-access timer from any tab

---

#### Quick Reference: Task Counts

| Phase | Tasks | Completed | Est. Time |
|-------|-------|-----------|-----------|
| 1: Performance & Quality | 13 | 13 | 8-10h |
| 2: State Management | 14 | 14 | 6-8h |
| 3: Audio Management | 11 | 11 | 4-5h |
| 4: Modernization | 12 | 0 | 8-10h |
| 5: Testing | 15 | 15 | 8-12h |
| 6: Performance Opt. | 12 | 0 | 5-7h |
| 7: Features & UX | 16 | 0 | Varies |
| 8: Developer Experience | 14 | 0 | 4-5h |
| 9: Documentation | 8 | 0 | 3-4h |
| 10: Maintenance | 8 | 0 | 2-3h |
| **TOTAL** | **123** | **53** | **~55-75h** |

---

#### Recommended Execution Strategy (updated)

- Completed: Phases 1, 2, 3, and 5 (foundation, state, audio, tests).
- Next priority: Phase 4 (Modernization & Refactor) and Phase 6 (Performance).
- Short-term goals:
  - Add coverage enforcement in CI and ensure Jest module resolution fixes are present.
  - Complete React Router upgrade and lazy-loading for routes.
  - Run bundle analysis and begin memoization pass.

---

#### Success Metrics

- Bundle Size: Target: < 250KB gzipped
- Initial Load Time: Target: < 2s on 4G
- Time to Interactive: Target: < 3s
- Test Coverage: Target: > 80%
- Lighthouse Score: Target: > 90 (all categories)
- Accessibility: Target: WCAG AA compliant
- Code Duplication: Target: < 5%
- Type Safety: Target: TypeScript or JSDoc 100% (if applicable)

---

#### Notes for Future Contributors

- This roadmap is a living document‚Äîupdate as priorities change
- Some tasks can be parallelized (testing, documentation)
- Phases are not strictly sequential‚Äîskip or reorder as needed
- Always run tests after completing a phase
- Keep git history clean with meaningful commit messages
- Link PRs to specific tasks in this roadmap
- Celebrate completed phases! üéâ

---

Would you like me to:
- Commit this updated Markdown file (ROADMAP.md) and provide it as a downloadable file, or
- Open a draft PR description summarizing the completed work for Phases 1‚Äì3 and listing next steps for Phase 4 & 6?

Reply with:
- "Commit" ‚Äî I will produce ROADMAP.md content ready to save/commit, or
- "Draft PR" ‚Äî I will produce a ready-to-paste PR description, or
- "Both" ‚Äî I will produce both the ROADMAP.md content and a PR description.